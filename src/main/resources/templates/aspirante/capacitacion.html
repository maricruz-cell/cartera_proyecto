<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Capacitación</title>

    <link rel="stylesheet" th:href="@{/css/aspirante-menu.css}">
    <link rel="stylesheet" th:href="@{/css/capacitacion.css}">
</head>

<body>

<div class="layout">

    <!-- HEADER -->
    <header class="topbar">
        <div class="topbar-left">
            <span class="brand">EMPLEO</span>
            <button id="toggleSidebar" class="menu-toggle">
                <span></span><span></span><span></span>
            </button>
        </div>

        <div class="topbar-right">
            <img class="avatar" th:src="@{${fotoAspirante}}" alt="Avatar">
            <span class="user-name" th:text="${nombreAspirante}">Aspirante</span>
        </div>
    </header>

    <div class="body">

        <!-- SIDEBAR -->
        <aside id="sidebar" class="sidebar">
            <ul>
                <li><a th:href="@{/aspirante/datos-personales}">Datos Personales</a></li>
                <li><a th:href="@{/aspirante/escolaridad}">Escolaridad</a></li>
                <li><a th:href="@{/aspirante/experiencia-laboral}">Experiencia Laboral</a></li>
                <li class="active"><a th:href="@{/aspirante/capacitacion}">Capacitación</a></li>
                <li><a th:href="@{/aspirante/conocimientos}">Conocimientos</a></li>
                <li><a th:href="@{/aspirante/competencias}">Competencias</a></li>
                <li><a th:href="@{/aspirante/cargardocumentos}">Cargar Documentos</a></li>
                <li><a th:href="@{/aspirante/cambiar-contrasena}">Contraseña</a></li>
                <li><a th:href="@{/aspirante/eliminar-cuenta}">Eliminar Usuario</a></li>
            </ul>

            <div class="logout-section">
                <a th:href="@{/logout}" class="logout-btn">CERRAR SESIÓN</a>
            </div>
        </aside>

        <!-- CONTENIDO -->
        <main class="content">

            <h2 class="titulo-seccion">CAPACITACIÓN</h2>
            <p class="sub-text">Gestiona tus capacitaciones realizadas.</p>

            <button class="btn-add" onclick="mostrarFormulario()">+ Agregar nuevo</button>

            <!-- TABLA -->
            <table class="tabla-registros">
                <thead>
                <tr>
                    <th>Curso</th>
                    <th>Área</th>
                    <th>Otra área</th>
                    <th>Tipo</th>
                    <th>Institución</th>
                    <th>Horas</th>
                    <th>Inicio</th>
                    <th>Fin</th>
                    <th>Documento</th>
                    <th>Acciones</th>
                </tr>
                </thead>

                <tbody>
                <tr th:each="c : ${listaCapacitacion}">
                    <td th:text="${c.descCurso}"></td>
                    <td th:text="${c.areaCapacitacionNombre}"></td>
                    <td th:text="${c.desOtraCapacitacion}"></td>
                    <td th:text="${c.tipoCursoNombre}"></td>
                    <td th:text="${c.institucionNombre}"></td>
                    <td th:text="${c.horasCursoNombre}"></td>
                    <td th:text="${c.descFechaInicio}"></td>
                    <td th:text="${c.descFechaFin}"></td>
                    <td th:text="${c.tipoDocumentoNombre}"></td>

                    <td>
                        <a th:href="@{'/aspirante/capacitacion/editar/' + ${c.idCapacitacion}}"
                           class="btn-edit">Editar</a>
                        <a th:href="@{'/aspirante/capacitacion/eliminar/' + ${c.idCapacitacion}}"
                           class="btn-delete"
                           onclick="return confirm('¿Eliminar registro?')">Eliminar</a>
                    </td>
                </tr>
                </tbody>
            </table>

            <!-- FORMULARIO -->
            <div id="form-capacitacion"
                 th:class="${mostrarForm} ? 'form-box' : 'form-box hidden'">

                <h2 class="titulo-seccion">Nueva Capacitación</h2>

                <form th:action="@{/aspirante/capacitacion/guardar}"
                      th:object="${capacitacionForm}"
                      method="post"
                      enctype="multipart/form-data">

                    <input type="hidden" th:field="*{idCapacitacion}">
                    <input type="hidden" th:field="*{idPersona}">

                    <input type="text"
                           th:field="*{descCurso}"
                           placeholder="Nombre del curso"
                           required>

                    <select th:field="*{idAreaCapacitacion}" required>
                        <option value="">-- Área --</option>
                        <option th:each="a : ${areasCapacitacion}"
                                th:value="${a.idAreaCapacitacion}"
                                th:text="${a.desArea}">
                        </option>
                    </select>

                    <input type="text"
                           th:field="*{desOtraCapacitacion}"
                           placeholder="Otra área (opcional)">

                    <select th:field="*{idTipoCurso}" required>
                        <option value="">-- Tipo de curso --</option>
                        <option th:each="t : ${tiposCurso}"
                                th:value="${t.idTipoCurso}"
                                th:text="${t.desTipo}">
                        </option>
                    </select>

                    <select th:field="*{idInstitucion}" required>
                        <option value="">-- Institución --</option>
                        <option th:each="i : ${institucionesCapacitacion}"
                                th:value="${i.idInstitucion}"
                                th:text="${i.desInstitucion}">
                        </option>
                    </select>

                    <select th:field="*{idHorasCurso}" required>
                        <option value="">-- Horas --</option>
                        <option th:each="h : ${horasCurso}"
                                th:value="${h.idHorasCurso}"
                                th:text="${h.desHoras}">
                        </option>
                    </select>

                    <input type="date" th:field="*{descFechaInicio}" required>
                    <input type="date" th:field="*{descFechaFin}" required>

                    <select th:field="*{idDocumento}" required>
                        <option value="">-- Documento --</option>
                        <option th:each="d : ${documentosCapacitacion}"
                                th:value="${d.idDocumento}"
                                th:text="${d.descripcion}">
                        </option>
                    </select>

                    <div class="form-actions">
                        <button type="submit">GUARDAR</button>
                        <button type="button" onclick="cancelar()">CANCELAR</button>
                    </div>

                </form>
            </div>

        </main>
    </div>
</div>

<script th:src="@{/js/aspirante-menu.js}"></script>

<script>
    function mostrarFormulario() {
        document.getElementById("form-capacitacion").classList.remove("hidden");
    }

    function cancelar() {
        document.getElementById("form-capacitacion").classList.add("hidden");
    }
</script>

</body>
</html>
