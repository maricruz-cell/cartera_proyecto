<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Eliminar Usuario</title>

    <link rel="stylesheet" th:href="@{/css/aspirante-menu.css}">
    <link rel="stylesheet" th:href="@{/css/eliminar-cuenta.css}">
</head>
<body>

<div class="layout">

    <!-- TOPBAR -->
    <header class="topbar">
        <div class="topbar-left">
            <span class="brand">EMPLEO</span>
            <button id="toggleSidebar" class="menu-toggle"><span></span><span></span><span></span></button>
        </div>

        <div class="topbar-right">
            <img class="avatar" th:src="@{${fotoAspirante}}">
            <span class="user-name" th:text="${nombreAspirante}">Aspirante</span>
        </div>
    </header>

    <div class="body">

        <!-- SIDEBAR -->
        <aside id="sidebar" class="sidebar">
            <ul>
                <li><a th:href="@{/aspirante/datos-personales}"><img src="/img/icon-datos.png"><span>Datos Personales</span></a></li>
                <li><a th:href="@{/aspirante/escolaridad}"><img src="/img/icon-escolaridad.png"><span>Escolaridad</span></a></li>
                <li><a th:href="@{/aspirante/experiencia-laboral}"><img src="/img/icon-experiencia.png"><span>Experiencia Laboral</span></a></li>
                <li><a th:href="@{/aspirante/capacitacion}"><img src="/img/icon-capacitacion1.png"><span>Capacitación</span></a></li>
                <li><a th:href="@{/aspirante/conocimientos}"><img src="/img/icon-conocimiento.png"><span>Conocimientos Específicos</span></a></li>
                <li><a th:href="@{/aspirante/competencias}"><img src="/img/icon-competencias.png"><span>Competencias y Habilidades</span></a></li>
                <li><a th:href="@{/aspirante/cambiar-contrasena}"><img src="/img/icon-password.png"><span>Cambiar Contraseña</span></a></li>

                <li class="active"><a th:href="@{/aspirante/eliminar-cuenta}">
                    <img src="/img/icon-eliminar.png">
                    <span>Eliminar Usuario</span>
                </a></li>
            </ul>

            <div class="logout-section">
                <a th:href="@{/logout}" class="logout-btn">CERRAR SESIÓN</a>
            </div>
        </aside>

        <!-- CONTENIDO -->
        <main id="content" class="content">

            <div class="card-delete">

                <h2 class="titulo-seccion">ELIMINAR USUARIO</h2>

                <p class="sub-text">
                    Aviso: Esta acción es <b>permanente e irreversible.</b>
                    Al eliminar al usuario, se perderá su acceso y los datos asociados
                    podrán ser depurados según las políticas vigentes.
                </p>

                <ul class="lista-aviso">
                    <li>Verifica que seleccionaste al usuario correcto.</li>
                    <li>Asegúrate de contar con la autorización correspondiente.</li>
                </ul>

                <p class="usuario-label">
                    <b>USUARIO A ELIMINAR:</b>
                    <span class="usuario-eliminar" th:text="${usuarioEliminar.correo}"></span>
                </p>

                <form th:action="@{/aspirante/eliminar-cuenta}" method="post" onsubmit="return abrirModal();">

                    <label>MOTIVO DE LA ELIMINACIÓN:</label>
                    <input type="text" id="motivo" name="motivo"
                           placeholder="Escriba el motivo de la eliminación">

                    <div class="chk-box">
                        <input type="checkbox" id="confirmado" name="confirmado">
                        <label for="confirmado">Entiendo que esta acción no se puede deshacer.</label>
                    </div>

                    <div class="acciones">
                        <button type="button" class="btn-cancelar"
                                onclick="window.location.href='/aspirante/datos-personales'">
                            CANCELAR
                        </button>

                        <button type="submit" class="btn-eliminar">ELIMINAR</button>
                    </div>

                </form>
            </div>

            <div class="footer-aspirante">
                SUBDIRECCIÓN DE RECLUTAMIENTO Y SELECCIÓN DEL PERSONAL
            </div>

        </main>
    </div>
</div>

<!-- MODAL -->
<div id="modalConfirm" class="modal-overlay hidden">
    <div class="modal-card">
        <p class="modal-text">¿Está seguro que desea guardar los cambios?</p>

        <div class="modal-actions">
            <button class="btn-aceptar" onclick="confirmarEnvio();">ACEPTAR</button>
            <button class="btn-cancelar-modal" onclick="cerrarModal();">CANCELAR</button>
        </div>
    </div>
</div>

<script>
    function abrirModal() {
        let motivo = document.getElementById("motivo").value.trim();
        let chk = document.getElementById("confirmado").checked;

        if (motivo === "" || !chk) {
            alert("Debe escribir un motivo y aceptar que entiende la acción.");
            return false;
        }

        document.getElementById("modalConfirm").classList.remove("hidden");
        return false;
    }

    function cerrarModal() {
        document.getElementById("modalConfirm").classList.add("hidden");
    }

    function confirmarEnvio() {
        document.querySelector("form").submit();
    }
</script>

<script th:src="@{/js/aspirante-menu.js}"></script>

</body>
</html>
