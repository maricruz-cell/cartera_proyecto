<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Datos Personales</title>
    <style>
        /* ——— estilos mínimos para cuadrícula y tarjetas ——— */
        .seccion { background:#fff; border-radius:8px; box-shadow:0 1px 4px rgba(0,0,0,.08); padding:18px 20px; margin-bottom:18px; }
        .seccion h2 { text-align:center; color:#7B1E3D; letter-spacing:.5px; margin-bottom:14px; }
        .grid { display:grid; grid-template-columns: repeat(3, 1fr); gap:12px 18px; }
        .grid-2 { grid-template-columns: repeat(2, 1fr); }
        .fila { display:flex; flex-direction:column; }
        label { font-size:14px; color:#333; margin-bottom:6px; }
        input[type="text"], input[type="date"], input[type="number"], select {
          width:100%; padding:8px 10px; border:1px solid #d9c9c9; border-radius:4px; background:#fffafc;
        }
        input[readonly] { background:#f7f1f3; color:#555; }
        .acciones { display:flex; justify-content:flex-end; gap:12px; margin-top:16px; }
        .btn { border:none; border-radius:20px; padding:9px 18px; cursor:pointer; font-weight:600; }
        .btn-sec { background:#eee; color:#7B1E3D; }
        .btn-prim { background:#7B1E3D; color:#fff; }
        .nota { font-size:12px; color:#666; margin-bottom:8px; }
        @media (max-width: 1100px) { .grid{ grid-template-columns:1fr; } }
    </style>
</head>
<body>

<!-- Fragmento que el layout inserta -->
<div th:fragment="contenido">

    <!-- FORM principal: bindea contra dtPersona -->
    <form th:action="@{/aspirante/guardarDatos}" th:object="${dtPersona}" method="post" id="formDtPersona">
        <!-- Relación con sb_persona -->
        <input type="hidden" th:field="*{idPersona}"/>

        <!-- ===================== DATOS PERSONALES (sb_persona + dt_persona) ===================== -->
        <section class="seccion">
            <h2>DATOS PERSONALES</h2>

            <div class="grid">
                <!-- sb_persona: solo lectura -->
                <div class="fila">
                    <label>Nombre(s):</label>
                    <input type="text" th:value="${personaBase.nombre}" readonly>
                </div>
                <div class="fila">
                    <label>Apellido Paterno:</label>
                    <input type="text" th:value="${personaBase.apellidoPaterno}" readonly>
                </div>
                <div class="fila">
                    <label>Apellido Materno:</label>
                    <input type="text" th:value="${personaBase.apellidoMaterno}" readonly>
                </div>

                <div class="fila">
                    <label>CURP:</label>
                    <input type="text" th:value="${personaBase.curp}" readonly>
                </div>
                <div class="fila">
                    <label>RFC:</label>
                    <input type="text" th:value="${personaBase.rfc}" readonly>
                </div>
                <div class="fila">
                    <label>Nacionalidad:</label>
                    <input type="text" value="MEXICANA" readonly>
                </div>

                <!-- dt_persona -->
                <div class="fila">
                    <label>Fecha de Nacimiento:</label>
                    <input type="date" th:field="*{fechaNacimiento}" id="fechaNacimiento">
                </div>
                <div class="fila">
                    <label>Edad:</label>
                    <input type="number" th:field="*{edad}" id="edad" min="0">
                </div>
                <div class="fila">
                    <label>Género:</label>
                    <!-- Si aún no tienes catálogo, deja estas opciones fijas -->
                    <select th:field="*{idSexo}">
                        <option value="">Seleccionar</option>
                        <option value="1">Femenino</option>
                        <option value="2">Masculino</option>
                        <option value="3">No especifica</option>
                    </select>
                </div>

                <div class="fila">
                    <label>Estado Civil:</label>
                    <select th:field="*{idEstadoCivil}">
                        <option value="">Seleccionar</option>
                        <option value="1">Soltero(a)</option>
                        <option value="2">Casado(a)</option>
                        <option value="3">Unión libre</option>
                        <option value="4">Divorciado(a)</option>
                        <option value="5">Viudo(a)</option>
                    </select>
                </div>
            </div>
        </section>

        <!-- ===================== DIRECCIÓN ===================== -->
        <section class="seccion">
            <h2>DIRECCIÓN</h2>
            <div class="grid">
                <div class="fila">
                    <label>Estado:</label>
                    <input type="text" th:field="*{idEstado}" placeholder="SELECCIONAR">
                </div>
                <div class="fila">
                    <label>Municipio:</label>
                    <input type="text" th:field="*{idMunicipio}" placeholder="SELECCIONAR">
                </div>
                <div class="fila">
                    <label>Localidad:</label>
                    <input type="text" th:field="*{idLocalidad}" placeholder="SELECCIONAR">
                </div>

                <div class="fila">
                    <label>Colonia:</label>
                    <input type="text" th:field="*{colonia}" placeholder="SELECCIONAR">
                </div>
                <div class="fila">
                    <label>Calle:</label>
                    <input type="text" th:field="*{calle}" placeholder="CALLE">
                </div>
                <div class="fila">
                    <label>Código Postal:</label>
                    <input type="text" th:field="*{codigoPostal}" placeholder="CÓDIGO POSTAL">
                </div>

                <div class="fila">
                    <label>Número Exterior:</label>
                    <input type="text" th:field="*{numExterior}" placeholder="S/N">
                </div>
                <div class="fila">
                    <label>Número Interior:</label>
                    <input type="text" th:field="*{numInterior}" placeholder="S/N">
                </div>
                <div class="fila">
                    <label>Referencia/Dirección (opcional):</label>
                    <input type="text" th:field="*{direccion}" placeholder="Referencias, entre calles, etc.">
                </div>
            </div>
        </section>

        <!-- ===================== CONTACTO ===================== -->
        <section class="seccion">
            <h2>CONTACTO</h2>
            <p class="nota">
                Importante: el número y correo de recados debe ser diferente al personal.
            </p>
            <div class="grid grid-2">
                <div class="fila">
                    <label>Número Personal (Celular):</label>
                    <input type="text" th:field="*{telefono}" placeholder="Escriba su número">
                </div>
                <div class="fila">
                    <label>Número de recados:</label>
                    <input type="text" th:field="*{telefonoRecados}" placeholder="Número de recados">
                </div>

                <div class="fila">
                    <label>Correo Electrónico (alterno):</label>
                    <input type="text" th:field="*{correoAlternativo}" placeholder="Correo alterno">
                </div>
                <div class="fila">
                    <label>Red Social (opcional):</label>
                    <input type="text" th:field="*{redSocial}" placeholder="@usuario">
                </div>
            </div>
        </section>

        <!-- ===================== DATOS ADICIONALES ===================== -->
        <section class="seccion">
            <h2>DATOS ADICIONALES</h2>
            <div class="grid grid-2">
                <div class="fila">
                    <label>¿Medio por el cuál se enteró?</label>
                    <select th:field="*{idDifusion}">
                        <option value="">Seleccionar</option>
                        <option value="1">Sitio web</option>
                        <option value="2">Redes sociales</option>
                        <option value="3">Recomendación</option>
                        <option value="4">Otro</option>
                    </select>
                </div>
                <div class="fila">
                    <label>¿Es usted servidor público?</label>
                    <select th:field="*{idServidor}">
                        <option value="">Seleccionar</option>
                        <option value="1">Sí</option>
                        <option value="0">No</option>
                    </select>
                </div>

                <div class="fila">
                    <label>Tipo de servidor (si aplica):</label>
                    <input type="text" th:field="*{idTipoServidor}" placeholder="Clave/Tipo">
                </div>
                <div class="fila">
                    <label>Sueldo deseado:</label>
                    <input type="text" th:field="*{idSueldo}" placeholder="$">
                </div>

                <div class="fila">
                    <label>Disponibilidad de horario:</label>
                    <select th:field="*{idDisponibilidadHorario}">
                        <option value="">Seleccionar</option>
                        <option value="1">Matutino</option>
                        <option value="2">Vespertino</option>
                        <option value="3">Tiempo completo</option>
                        <option value="4">Fin de semana</option>
                    </select>
                </div>
                <div class="fila">
                    <label>Disponibilidad para viajar:</label>
                    <select th:field="*{idDisponibilidadViajar}">
                        <option value="">Seleccionar</option>
                        <option value="1">Sí</option>
                        <option value="0">No</option>
                    </select>
                </div>

                <div class="fila">
                    <label>¿Actualmente se encuentra desempleado?</label>
                    <select th:field="*{esEmpleado}">
                        <option value="">Seleccionar</option>
                        <option th:value="0">Sí, está desempleado</option>
                        <option th:value="1">No, actualmente trabaja</option>
                    </select>
                </div>
            </div>

            <div class="acciones">
                <a th:href="@{/aspirante/menu}" class="btn btn-sec">Cancelar</a>
                <button type="submit" class="btn btn-prim">Guardar</button>
            </div>
        </section>

    </form>
</div>

<script>
    // Autocalcular edad al elegir fecha de nacimiento
    const fecha = document.getElementById('fechaNacimiento');
    const edad = document.getElementById('edad');

    if (fecha) {
      const calcEdad = () => {
        if (!fecha.value) return;
        const hoy = new Date();
        const fn = new Date(fecha.value + 'T00:00:00');
        let years = hoy.getFullYear() - fn.getFullYear();
        const m = hoy.getMonth() - fn.getMonth();
        if (m < 0 || (m === 0 && hoy.getDate() < fn.getDate())) years--;
        edad.value = years >= 0 ? years : 0;
      };
      fecha.addEventListener('change', calcEdad);
    }
</script>

</body>
</html>
